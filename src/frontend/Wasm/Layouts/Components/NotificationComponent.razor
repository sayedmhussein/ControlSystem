@using WeeControl.Host.WebApiService.Contexts.Essentials
@using WeeControl.Core.SharedKernel.Contexts.Essentials
@inject IHomeService Home

@foreach (var n in notifications)
{
    <MudMenuItem OnClick="@(args => { Home.MarkNotificationAsViewed(n.NotificationId);})">
        <MudCard Outlined="true" Square="true" Style="margin-outside: 0; background-color: #f8d7da">
            <MudCardContent>
                <MudText>@n.Subject</MudText>
                <MudText Typo="Typo.body2">@n.Body</MudText>
                <MudText Typo="Typo.body2">@n.PublishedTs</MudText>
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Text" Color="Color.Primary">
                    <MudLink Href="@n.NotificationUrl">Learn More</MudLink>
                </MudButton>
            </MudCardActions>
        </MudCard>
    </MudMenuItem> 
}

@code
{
    private IEnumerable<HomeNotificationModel> notifications = new List<HomeNotificationModel>();

    protected override async Task OnInitializedAsync()
    {
        notifications = await Home.GetNotifications();
        await base.OnInitializedAsync();
    }
}
